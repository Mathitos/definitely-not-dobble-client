(this["webpackJsonpdefinitely-not-dobble-client"]=this["webpackJsonpdefinitely-not-dobble-client"]||[]).push([[0],{22:function(e,n,t){e.exports=t(38)},28:function(e,n,t){},34:function(e,n,t){},35:function(e,n,t){},36:function(e,n,t){},37:function(e,n,t){},38:function(e,n,t){"use strict";t.r(n);t(23);var a=t(0),r=t.n(a),o=t(16),c=t(10),u=t(6),l=t(13),i=t(5),s=(t(28),function(){var e=Object(a.useState)({name:"",room:""}),n=Object(i.a)(e,2),t=n[0],o=n[1],c=Object(u.f)();return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t.name&&t.room&&c.push({pathname:"/dobble",search:"?"+new URLSearchParams({name:t.name,room:t.room}).toString()})},className:"login-form"},r.a.createElement("label",null,r.a.createElement("span",null,"Seu Nome:"),r.a.createElement("input",{value:t.name,onChange:function(e){var n=e.target.value;o(Object(l.a)({},t,{name:n}))}})," "),r.a.createElement("label",null,r.a.createElement("span",null,"Nome da Sala:"),r.a.createElement("input",{value:t.room,onChange:function(e){var n=e.target.value;o(Object(l.a)({},t,{room:n}))}})),r.a.createElement("button",{type:"submit"},"Submit")))}),m=t(21),f=new(t(19).Socket)("ws://".concat("defiant-blueviolet-greathornedowl.gigalixirapp.com","/socket"),{params:{user_token:"user_token_test"}});f.connect();var d=function(e,n){return f.channel(e,{name:n})},b=function(e){return e.disconnect()},g=function(e){return new Promise((function(n,t){e.join().receive("ok",(function(e){n(e)})).receive("error",(function(e){t?t(e):console.log("Unable to join on channel",e)})).receive("timeout",(function(e){return t?t(e):console.log("Networking issue. Still waiting...")}))}))},v=function(e,n,t){return e.on(n,t)},p=function(e,n,t){return new Promise((function(a,r){e.push(n,t).receive("ok",a).receive("error",r)}))},E=function(){var e=new Date;return"".concat(e.getHours(),": ").concat(e.getMinutes(),": ").concat(e.getSeconds())},h=function(e){return 0===e.id},_=function(e,n){return e.id===n.id},j=function(e,n){return n.filter((function(n){return!_(n.user,e)&&!h(n.user)}))},S=function(e){var n=e.find((function(e){return h(e.user)}));return(null===n||void 0===n?void 0:n.card)||null},O=function(e,n){var t=n.find((function(n){return _(n.user,e)}));return(null===t||void 0===t?void 0:t.card)||null},w=(t(34),function(e){var n=e.user_name,t=e.text,a=e.time;return r.a.createElement("span",{className:"chat__message"},r.a.createElement("span",{className:"chat__message-label"},"[".concat(a,"]: ").concat(n,":"))," ",r.a.createElement("span",null,"".concat(t)))}),y=function(e){var n=e.messages,t=e.onNewMessage,o=Object(a.useState)(""),c=Object(i.a)(o,2),u=c[0],l=c[1];return Object(a.useEffect)((function(){var e=document.getElementById("messages-container");e&&(e.scrollTop=e.scrollHeight)}),[n]),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),l(""),t(u)},className:"chat__container"},r.a.createElement("div",{id:"messages-container",className:"chat__messages-container"},n.map((function(e){return r.a.createElement(w,e)}))),r.a.createElement("div",{className:"chat__input-area"},r.a.createElement("input",{value:u,onChange:function(e){var n=e.target.value;return l(n)}}),r.a.createElement("button",{type:"submit"},"Send")))},N=t(20),k=t.n(N),x=(t(35),["Lavender","YellowGreen","Teal","SaddleBrown","Salmon","RebeccaPurple","Red","Magenta"]),M=function(e){return x[e%8]},P=function(e){return e%2===0?"normal":"bold"},R=function(e){return"".concat(e?7+Math.floor(3*Math.random()):14+Math.floor(10*Math.random()),"px")},C=function(e,n){return{color:M(e),fontSize:R(n),transform:"rotate(".concat(90-Math.floor(180*Math.random()),"deg)"),fontWeight:P(e)}},B=function(e){var n=e.card,t=e.onGuess,a=e.small,o=void 0!==a&&a;return r.a.createElement("div",{className:k()("dobble-game-card__container",o&&"dobble-game-card__container--small")},n.map((function(e){return r.a.createElement("button",{key:e,className:"dobble-game-card__button",style:C(e,o),onClick:function(){return t&&t(e)},tabIndex:t?0:-1,disabled:!t},e)})))},D=(t(36),function(e){var n=e.players;return r.a.createElement("div",{className:"game-room__other-players-info"},n.map((function(e){return r.a.createElement("div",{className:"game-room__other-player",key:e.user.id},r.a.createElement(B,{card:e.card,small:!0}),r.a.createElement("span",null,e.user.name))})))}),G=function(e){var n=e.location.search,t=new URLSearchParams(n),o=t.get("name")||"Anonymous",c=t.get("room"),u=Object(a.useState)(d("room:".concat(c),o)),l=Object(i.a)(u,1)[0],s=Object(a.useState)(null),f=Object(i.a)(s,2),h=f[0],_=f[1],w=Object(a.useState)([]),N=Object(i.a)(w,2),k=N[0],x=N[1],M=Object(a.useState)([]),P=Object(i.a)(M,2),R=P[0],C=P[1],G=Object(a.useRef)(R);Object(a.useEffect)((function(){G.current=R}),[R]);var I=function(e){!function(e,n){C([].concat(Object(m.a)(G.current),[{user_name:e,text:n,time:E()}]))}(e.user_name,e.text)},L=function(e){var n=e.game_state;console.log(n),x(n)};Object(a.useEffect)((function(){return v(l,"message",I),v(l,"game_state_update",L),l.onError((function(){console.log("there was an error with the connection!")})),g(l).then((function(e){var n=e.id;return _(n)})),function(){b(l)}}),[]);var U=h&&O({id:h,name:o},k),H=S(k),J=h?j({id:h,name:o},k):[];return r.a.createElement("div",{className:"game-room"},r.a.createElement(D,{players:J}),U&&H&&r.a.createElement(r.a.Fragment,null,r.a.createElement(B,{card:H,onGuess:function(e){p(l,"guess",{number:e}).then((function(e){"right"===e.response?console.log("top\xea\xea\xea"):console.log("vc \xe9 meio burro n\xe9?")}))}}),r.a.createElement(B,{card:U})),r.a.createElement("div",{className:"game-room__chat"},r.a.createElement(y,{messages:R,onNewMessage:function(e){p(l,"message",{text:e})}})))},I=function(){return a.createElement(c.a,null,a.createElement(u.c,null,a.createElement(u.a,{exact:!0,path:"/definitely-not-dobble-client/",component:s}),a.createElement(u.a,{exact:!0,path:"/definitely-not-dobble-client/dobble",component:G})))};t(37);o.render(a.createElement(I,null),document.getElementById("definitely-not-dobble-root"))}},[[22,1,2]]]);
//# sourceMappingURL=main.1ddb0aac.chunk.js.map